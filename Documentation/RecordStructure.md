# Стуктура файла записи
Файлы записи являются JSON, закодированным в BSON

Типовая структура файла:
```json
"objects":
[
    {
        "id": 0,
        "name": "UAV",
        "color": [
            0,
            1,
            0
        ],
        "static": false,
        "type": "box",
        "half_dimentions": [
            0.15000000596046448,
            0.07500000298023224,
            0.15000000596046448
        ]
    },
    {
        "id": 12,
        "name": "UAV-With-Lidar",
        "color": [
            0,
            1,
            0
        ],
        "static": false,
        "type": "box",
        "half_dimentions": [
            0.15000000596046448,
            0.07500000298023224,
            0.15000000596046448
        ]
    }
],
"frames":
[
    {
        "states":
        [
            {
                "id": 0,
                "i": "i",
                "m":"Metadata",
                "p":
                [
                    -4.9,
                    0.43,
                    0.24
                ],
                "r":
                [
                    0,
                    0,
                    0,
                    1
                ]
            },
            {
                "id": 1,
                "i": "d",
                "m":"Metadata",
                "p":
                [
                    -0.9,
                    0.5,
                    0.78
                ],
                "r":
                [
                    0.5654819011688232,
                    -0.016946595162153244,
                    -0.5436973571777344,
                    0.61994868516922
                ]
            }
        ],
        "cmd":
        [
            {
                "t": "c",
                "ox": 0,
                "oy": 16.5,
                "oz": 0,
                "rx": 1,
                "ry": 0,
                "rz": 0,
                "rw": 0,
                "sx": 100,
                "sy": 16.5,
                "sz": 150.5,
                "r": 1,
                "g": 0,
                "b": 0,
                "o": 0.05
            }
        ],
        "t": 0.03333333507180214
    },
    {
        //Следующий кадр
    }
]
```

## Список objects
Содержит описание всех объектов записи.

Стуктура объекта:
```json
{
    "id": 0,
    "name": "UAV",
    "color": [
        0,
        1,
        0
    ],
    "static": false,
    "type": "box",
    "half_dimentions": [
        0.15,
        0.075,
        0.15
    ],
    "radius": 2.5,
    "vertices":
    [
        [
            0,
            1,
            0,
        ],
        [
            0.5,
            0,
            0,
        ],
        [
            0,
            0,
            0.5,
        ],
        [
            0.5,
            0,
            0.5,
        ]
    ]

}
```

|Параметр|Описание|Тип|Значения|
|--|--|--|--|
|id|ID объекта записи|int| >= 0|
|name|Имя объекта записи|string||
|color|Цвет объекта в RGB формате. Каждый канал от 0 до 1|array[float]|от [0, 0, 0] до [1, 1, 1]|
|static|Тип геометрии. Если статическая* - true, если динамическая** - false|bool|true/false|
|type|Тип геометрии объекта|string|box - для кубов и параллелепипедов; sphere - для сфер, capsule - для капсул, convex - для выпуклых тел произвольной формы|
|half_dimentions|Половоны размеров куба|array[float]| > [0, 0, 0]|
|radius|Радиус сферы/капсулы|float| > 0|
|half_height|Половина высоты капсулы|float| > 0|
|vertices|Список вершин выпуклой геометрии|array[array[float]]||

*Динамичекая геометрия - создается, перемещается по сцене, удаляется;\
**Статическая геометрия - создается, удаляется.

## Список frames
Содержит описание кадров записи, состояние объектов, команды для отрисовки отладочной геометрии и текущее время записи.

```json
{
    "states":
    [
        //состояния объектов
    ],
    "cmd":
    [
        //команды отладочной геометри
    ],
    "t": 0.03 //текущее время записи
},
```

### states
Список состояний объектов

```json
{
    "id": 0,
    "i": "i",
    "m":"Metadata",
    "p":
    [
        -4.9,
        0.43,
        0.24
    ],
    "r":
    [
        0,
        0,
        0,
        1
    ]
},
{
    //следующий объект
}
```

|Параметр|Описание|Тип|Значения|
|--|--|--|--|
|id|ID объекта записи|int| >= 0|
|i|Экземляр. Если значение "i" - объект будет отрисован. Используется для отображения добавляемых/удаляемых объектов|string|"i"/"d"|
|m|Метаданные объекта, отбражаемые в списке его свойств|string||
|p|Текущая позиция объекта, описываемая Vector3|array[float]||
|r|Текущее вращение объекта, описываемое Quaternion|array[float]|Длина кватерниона: 1|

### cmd
Список команд отладочной геометрии

```json
{
    "t": "c",
    "ox": 0,
    "oy": 16.5,
    "oz": 0,
    "rx": 1,
    "ry": 0,
    "rz": 0,
    "rw": 0,
    "sx": 100,
    "sy": 16.5,
    "sz": 150.5,
    "r": 1,
    "g": 0,
    "b": 0,
    "o": 0.05
}
{
    //следующая команда
}
```

|Параметр|Описание|Тип|Значения|
|--|--|--|--|
|t|Тип геометрии|string| "v" - вектор, "r" - луч, "s" - сфера, "c" - куб|
|r|Канал красного цвета геометрии|float|[0, 1]|
|g|Канал зеленого цвета геометрии|float|[0, 1]|
|b|Канал синего цвета геометрии|float|[0, 1]|
|o|Непрозрачность геометрии. 0 - объект прозрачен, 1 - объект не прозрачен|float|[0, 1]|
|ox|Позиция объекта по оси X. Для векторов и лучей - начало, для сфер и кубов - центр|float||
|oy|Позиция объекта по оси Y. Для векторов и лучей - начало, для сфер и кубов - центр|float||
|oz|Позиция объекта по оси Z. Для векторов и лучей - начало, для сфер и кубов - центр|float||
|ex|Координата X конца луча|float||
|ey|Координата Y конца луча|float||
|ez|Координата Z конца луча|float||
|vx|X компонента вектора. Коордианата конца вектора отностителного его начала|float||
|vy|Y компонента вектора. Коордианата конца вектора отностителного его начала|float||
|vz|Z компонента вектора. Коордианата конца вектора отностителного его начала|float||
|sr|Радиус сферы|float| > 0|
|sx|Половина размера куба по оси X|float| > 0|
|sy|Половина размера куба по оси Y|float| > 0|
|sz|Половина размера куба по оси Z|float| > 0|
|rx|X компонента кватерниона, описывающего вращение куба. Образует кватернион|float| > 0|
|ry|Y компонента кватерниона, описывающего вращение куба. Образует кватернион|float| > 0|
|rz|Z компонента кватерниона, описывающего вращение куба. Образует кватернион|float| > 0|
|rw|W компонента кватерниона, описывающего вращение куба. Образует кватернион|float| > 0|
